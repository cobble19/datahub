# cud_dataset.yaml
name: "cud_dataset"
source:
  type: "kafka"
  config:
    connection:
      bootstrap: ${KAFKA_BOOTSTRAP_SERVER:-localhost:9092}
      schema_registry_url: ${SCHEMA_REGISTRY_URL:-http://localhost:8081}
    topic_routes:
      mcl: ${METADATA_CHANGE_LOG_VERSIONED_TOPIC_NAME:-DataHubMetadataChangeLog_Versioned_v1}
      pe: ${PLATFORM_EVENT_TOPIC_NAME:-DataHubPlatformEvent_v1}
action:
  type: "wap_actions.change_monitor:CudDatasetCacheRefreshAction"
  config:
    output_json: ${OUTPUT_JSON:-false}
    actions_home: ${DATAHUB_ACTIONS_HOME}
    entity_types:
      - dataset
    entity_props:
      - TABLE_NAME=*
    ci_config:
      access_token_url: ${CI_ACCESS_TOKEN_URL:-https://idbroker.webex.com/idb/oauth2/v1/access_token}
      username: ${CI_ACCESS_TOKEN_USER:-C51206cd701b886ee1ae9aa9157c0c8624787c8f10bfa9ce267164dda01f5df91}
      password: ${CI_ACCESS_TOKEN_PASS:-pass}
      bearer_token_url: ${CI_BEARER_TOKEN_URL:-https://idbroker.webex.com/idb/token/6078fba4-49d9-4291-9f7b-80116aab6974/v2/actions/GetBearerToken/invoke}
      machine_account_name: ${CI_MACHINE_NAME:-CTGWAP-DATAHUB}
      machine_account_pass: ${CI_MACHINE_PASS:-pass}
    callbacks:
      - region: All
        url: https://wapdavis.webex.com/davis/api/v1/reload-cache/
